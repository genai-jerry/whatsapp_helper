<!-- A table showing the revenue goal, revenue projection and actual revenue -->
<div class="card mt-2">
    <div class="card-header">
        <div class="row">
            <div class="col-md-10">
                <h4>Revenue Metrics</h4>
            </div>
        </div>
    </div>
    <div class="card-body">
        <div class="row mt-2">
            <div class="col-md-6">
                <h5>Total Projected Revenue: Rs <span id="totalProjectedRevenue">0</span></h5>
                <h5>Total Projected Cost: Rs <span id="totalProjectedCost">0</span></h5>
                <h5>Net Projected Profit: Rs <span id="totalProjectedProfit">0</span></h5>
                <h5>Projected ROI: <span id="totalProjectedROI">0</span>x</h5>
            </div>
            <div class="col-md-6">
                <h5>Total Actual Revenue: Rs <span id="totalActualRevenue">0</span></h5>
                <h5>Total Actual Cost: Rs <span id="totalActualCost">0</span></h5>
                <h5>Net Actual Profit: Rs <span id="totalActualProfit">0</span></h5>
                <h5>Actual ROI: <span id="totalActualROI">0</span>x</h5>
            </div>
        </div>
    </div>
</div>

<div class="card mb-4">
    <div class="card-header">
        <div class="row">
            <div class="col-md-10">
                <h4>Sales Funnel Metrics</h4>
            </div>
        </div>
    </div>
    <form id="salesProjectionForm" class="mt-3" action="/metrics/projections/config" method="post">
    <div class="card-body">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Metric</th>
                    <th>Goal</th>
                    <th>Goal Value</th>
                    <th>Projected Rate</th>
                    <th>Projected Value</th>
                    <th>Projected Cost</th>
                    <th>Actual Cost</th>
                    <th>Actual Value</th>
                    <th>Actual Rate</th>
                </tr>
            </thead>
            <input type="hidden" id="sales_slots_possible" value="{{sales_metrics.total_call_slots}}">
            <tbody>
                <tr>
                    <td>Leads</td>
                    <td>For <b>{{sales_metrics.total_call_slots}}</b> Sales Slots</td>
                    <td><input type="number" id="lead_generation_goal" class="form-control" value="" readonly>
                    </td>
                    <td>For <b>{{sales_metrics.total_call_slots}}</b> Sales Slots</td>
                    <td><input type="number" id="lead_generation_projection" class="form-control" value="" readonly>
                        </td>
                    <td>Rs <span id="projected_lead_cost">0</span></td>
                    <td><span id="actual_lead_cost"></span></td>
                    <td><span id="actual_lead_value">{{opportunity_count}}</span></td>
                    <td><span id="actual_lead_rate"></span></td>
                </tr>
                <tr>
                    <td>Appointments</td>
                    <td><input type="number" id="appointment_booked_goal" name="appointment_booked_goal" class="form-control" value="{{projection_config.appointment_booked_goal}}" required> %</td>
                    <td><span id="appointment_booked_goal_value">0</span></td>
                    <td><input type="number" id="appointment_booked_projection" name="appointment_booked_projection" class="form-control" value="{{projection_config.appointment_booked_projection}}" required> %</td>
                    <td><span id="appointment_booked_projection_value">0</span></td>
                    <td>Rs <span id="appointment_booked_cost">0</span></td>
                    <td>Rs <span id="actual_appointment_booked_cost">0</span></td>
                    <td><span id="appointment_booked_count">{{performance_metrics.total_appointments_booked}}</span></td>
                    <td><span id="actual_appointment_booked_rate"></span></td>
                </tr>
                <tr>
                    <td>Show Ups</td>
                    <td><input type="number" id="show_up_rate_goal" name="show_up_rate_goal" class="form-control" value="{{projection_config.show_up_rate_goal}}" required> %</td>
                    <td><span id="show_up_rate_goal_value">0</span></td>
                    <td><input type="number" id="show_up_rate_projection" name="show_up_rate_projection" class="form-control" value="{{projection_config.show_up_rate_projection}}" required> %</td>
                    <td><span id="show_up_rate_projection_value">0</span></td>
                    <td>Rs <span id="show_up_rate_cost">0</span></td>
                    <td>Rs <span id="actual_show_up_rate_cost">0</span></td>
                    <td><span id="actual_show_up_rate_value">{{performance_metrics.total_appointments_attended}}</span></td>
                    
                    <td><span id="actual_show_up_rate"></span></td>
                </tr>
                <tr>
                    <td>Sales Closure</td>
                    <td><input type="number" id="close_rate_goal" class="form-control" value="{{sales_metrics.goal_closure_rate}}" readonly> %</td>
                    <td><span id="sales_goal_closure_rate_value">0</span></td>
                    <td><input type="number" id="close_rate_projection" class="form-control" value="{{sales_metrics.projected_closure_rate}}" readonly> %</td>
                    <td><span id="sales_projected_closure_rate_value">0</span></td>
                    <td>Rs <span id="sales_projected_closure_cost">0</span></td>
                    <td>Rs <span id="actual_sales_closure_cost">0</span></td>
                    <td><span id="actual_sales_closure_rate_value">{{performance_metrics.total_sales_final}}</span></td>
                    <td><span id="actual_sales_closure_rate"></span></td>
                </tr>
               
            </tbody>
        </table>
    </div>
    <div class="card-footer">
        <div class="form-group">
            <label for="costPerLead">Cost per Lead (Rs):</label>
            <input type="number" id="costPerLead" class="form-control input-number" name="cost_per_lead" 
                value="{{ projection_config.cost_per_lead }}">
        </div>
        <div class="form-group">
            <label for="averageSaleValue">Sale Price (Rs):</label>
            <input type="number" id="averageSaleValue" class="form-control input-number" name="sale_price" 
                value="{{ projection_config.sale_price}}">
        </div>
        <div class="form-group">
            <button type="submit" class="btn btn-primary mt-2">Update</button>
        </div>
    </div>
    </form>
</div>
<script src="{{ url_for('static', filename='js/projections.js') }}"></script>