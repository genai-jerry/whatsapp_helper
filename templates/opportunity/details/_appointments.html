{% for appointment in opportunity.appointments %}
    <div class="col-md-3 mb-3">
        <div class="card">
            <h5 class="card-header">Date: {{ appointment.time.strftime('%b %d, %Y, %H:%M') }}</h5>
            <div class="card-body">
                <p class="card-text">Call Status: <b>{{ appointment.call_status }}</b></p>
                <p class="card-text">Booked Time: <b>{{ appointment.appointment_create_time.strftime('%b %d, %Y, %H:%M') }}</b></p>
            </div>
            <div class="card-footer {% if appointment.appointment_status == 'Sale' %}bg-success{% elif appointment.appointment_status == 'Follow up' or appointment.appointment_status == 'Rescheduled' %}bg-warning{% elif appointment.appointment_status == None %}bg-primary{% else %}bg-danger{% endif %}">
                {% if appointment.appointment_status == None %}
                    Call Pending
                {% else %}
                    {{ appointment.appointment_status }}
                {% endif %}
            </div>
        </div>
    </div>
{% endfor %}

<div class="mt-3">
    <button type="button" class="btn btn-primary me-2" data-bs-target="#taskListModal" data-opportunity-id="{{ opportunity.id }}">
        View Task List
    </button>
    <button type="button" class="btn btn-success" data-bs-target="#createTaskModal" data-opportunity-id="{{ opportunity.id }}" data-opportunity-name="{{ opportunity.name }}">
        Create New Task
    </button>
</div>

{% include 'task/list_modal.html' %}
{% include 'task/create_modal.html' %}
